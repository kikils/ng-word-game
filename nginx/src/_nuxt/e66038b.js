(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{375:function(e,t,n){"use strict";n.r(t);n(42),n(13),n(31),n(1),n(43),n(20),n(17);var o=n(47),r=n(110),c=n.n(r),l=n(113),v=n(77),d=n(30),m=(n(80),function(e){var t=new FileReader;return new Promise((function(n,o){t.onerror=function(){t.abort(),o()},t.onload=function(){n(t.result)},t.readAsText(e)}))}),f=function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(t);case 2:return n=e.sent,e.abrupt("return",JSON.parse(n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=Object(o.a)({name:"PlayerJoin",setup:function(){var e=Object(o.j)().app,t=Object(o.c)(l.b),n=Object(o.h)(""),r=Object(o.h)(!1),d=Object(o.h)(0),m=Object(o.h)(!1),x=Object(o.k)();if(!t)throw new Error("store undefined");var data=Object(o.g)(t.data),_=Object(o.h)(!1),h=Object(o.h)(!1),y=E(),w=Object(o.h)(),j=function(){c.a.get("http://".concat(e.$config.apiURL,"/rooms")).then((function(e){w.value=e.data.rooms}))};function C(){console.log("close"),x.push({name:"result"})}function E(){for(var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".split(""),i=0,t=e.length;i<t;i++)switch(e[i]){case"x":e[i]=Math.floor(16*Math.random()).toString(16);break;case"y":e[i]=(Math.floor(4*Math.random())+8).toString(16)}return e.join("")}Object(o.d)((function(){j(),setInterval((function(){j()}),5e3)})),Object(o.l)(data,(function(){console.log("here"),data.game_state===v.b.PlayerFilled&&(_.value=!1,x.push({name:"odai"}))}),{deep:!0});return{name:n,maxPlayer:d,connectError:h,createRoom:function(){if(0!==n.value.length)if(d.value<2)m.value=!0;else{r.value=!1,m.value=!1,t.setName(n.value),t.setClientId(y),_.value=!0;var o=new WebSocket("ws://".concat(e.$config.apiURL,"/?id=").concat(y,"&name=").concat(n.value,"&roomId=").concat(E(),"&newRoom=true&maxPlayer=").concat(d.value));console.log(o),o.addEventListener("error",(function(){h.value=!0})),o.addEventListener("open",(function(){console.log("open"),o.addEventListener("message",(function(e){f(e.data).then((function(e){console.log(e),t.setData(e)}))})),o.addEventListener("close",C,!1),t.setSocket(o)}))}else r.value=!0},waiting:_,rooms:w,joinRoom:function(o){if(0!==n.value.length){r.value=!1,t.setName(n.value),t.setClientId(y),_.value=!0;var c=new WebSocket("ws://".concat(e.$config.apiURL,"/?id=").concat(y,"&roomId=").concat(o,"&newRoom=false&name=").concat(n.value,"&maxPlayer=0"));console.log(c),c.addEventListener("error",(function(){h.value=!0})),c.addEventListener("open",(function(){console.log("open"),c.addEventListener("message",(function(e){f(e.data).then((function(e){console.log(e),t.setData(e)}))})),c.addEventListener("close",C,!1),t.setSocket(c)}))}else r.value=!0},nameErr:r,maxPlayerErr:m}}}),_=n(76),component=Object(_.a)(x,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"d-flex justify-content-center align-items-center",staticStyle:{height:"100vh"}},[n("div",{staticClass:"card",staticStyle:{width:"75%"}},[n("div",{staticClass:"card-body"},[n("h4",{staticClass:"card-title text-center"},[e._v("\n        NG単語ゲーム\n      ")]),e._v(" "),n("div",{staticClass:"form-group d-flex flex-column justify-content-center"},[n("h5",{staticClass:"text-center"},[e._v("ユーザー名")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],staticClass:"form-control",attrs:{type:"text",placeholder:"ユーザー名"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}}),e._v(" "),e.nameErr?n("div",{staticClass:"form-text",staticStyle:{color:"red"}},[e._v("ユーザー名を入力してください")]):e._e(),e._v(" "),n("h5",{staticClass:"mt-3 text-center"},[e._v("ルームを作成")]),e._v(" "),n("div",{staticClass:"mx-auto form-inline justify-content-center"},[n("label",{attrs:{for:"inputMaxPlayer"}},[e._v("募集人数: ")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.maxPlayer,expression:"maxPlayer"}],staticClass:"mx-2 form-control",staticStyle:{width:"25%"},attrs:{id:"inputMaxPlayer",type:"number",placeholder:"人数"},domProps:{value:e.maxPlayer},on:{input:function(t){t.target.composing||(e.maxPlayer=t.target.value)}}}),e._v(" "),e.waiting?e.connectError?e._e():n("p",[e._v("\n            参加者を待っています....\n          ")]):n("button",{staticClass:"btn btn-outline-info",attrs:{type:"submit",disabled:e.waiting},on:{click:e.createRoom}},[e._v("\n            ルームを作成\n          ")]),e._v(" "),e.connectError?n("p",[e._v("サーバーと接続できません")]):e._e()]),e._v(" "),e.maxPlayerErr?n("div",{staticClass:"form-text text-center",staticStyle:{color:"red"}},[e._v("募集人数は2人以上にしてください")]):e._e()]),e._v(" "),n("h5",{staticClass:"py-3 text-center"},[e._v("募集中のルーム")]),e._v(" "),n("table",{staticClass:"table table-borderless"},[e._m(0),e._v(" "),n("tbody",e._l(e.rooms,(function(t){return n("tr",{key:t.id},[n("td",[e._v(e._s(t.players.join(", ")))]),e._v(" "),n("td",{staticClass:"text-center"},[e._v(e._s(t.num)+"/"+e._s(t.max_player))]),e._v(" "),n("td",{staticStyle:{width:"35%"}},[n("button",{staticClass:"btn btn-outline-info",on:{click:function(n){return e.joinRoom(t.id)}}},[e._v("参加")])])])})),0)])])])])}),[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("thead",[n("tr",[n("th",[e._v("参加ユーザー")]),e._v(" "),n("th",{staticClass:"text-center"},[e._v("参加人数/募集人数")]),e._v(" "),n("th")])])}],!1,null,null,null);t.default=component.exports}}]);